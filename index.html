<html>

  <head>
    <title>Stilr Killer</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <script type="text/javascript" src="babel.js"></script>
    <script type="text/babel">
      const style = {
        firstClass: {
          height: "100px",
          width: "200px",

          $firstClassModifier: {
            height: "777px",

            thingInsideIt: {
              color: "babyblue"
            }
          },

          secondClass: {
            color: "red",
            textAlign: "center"
          },

          "@media (max-width: 600px)": {
            fontSize: 8,
            fontWeight: "bold"
          }
        }
      };

      const allStyles = [];

      const createPrefix = (prefix, className) => {
        if(className[0] === "@") { // media query
          return [`${className} { ${prefix}`.trimLeft(), `} }`];
        }

        if(className[0] === "$") { // modifier
          const klass = className.substr(1, className.length-1);
          return [`${prefix}.${klass}`.trimLeft(), `}`];
        }

        return [`${prefix} .${className}`.trimLeft(), `}`];
      }


      const printStyle = (pre, className, styleObj) => {
        const [prefix, suffix] = createPrefix(pre, className);
        let styles = `${prefix} {`;

        for (var prop in styleObj) {
          if (styleObj.hasOwnProperty(prop)) {

            if(typeof styleObj[prop] === "object") {
              printStyle(prefix, prop, styleObj[prop]);
            } else {
              styles += prop+":"+styleObj[prop]+";";
            }

          }
        }

        styles += `${suffix}`;

        allStyles.push(styles);
      }


      const printStyles = (styleObj) => {
        for (var property in styleObj) {
          printStyle("", property, styleObj[property]);
        }
      }

      printStyles(style);

      for(let i = allStyles.length-1; i >=0; i--) {
        console.log(allStyles[i]);
      }
    </script>
  </body>

</html>